# Terraform Project Structure

Having a structured and well-organized project directory with multiple files can initially seem overwhelming, but it offers several long-term benefits, especially for larger projects and teams. Here are some reasons why this structure is advantageous:

## Simplified Project Structure

```txt
my-terraform-project/
├── main.tf
├── providers.tf
├── variables.tf
├── outputs.tf
└── environments/
    ├── dev.tfvars
    ├── staging.tfvars
    └── prod.tfvars
```

### Simplified File Contents

#### Root Directory Files

`main.tf`:

```hcl
provider "aws" {
  region = var.region
}

module "vpc" {
  source = "./modules/vpc"
  cidr_block = "10.0.0.0/16"
  name = "example-vpc"
}

module "ec2" {
  source = "./modules/ec2"
  instance_type = "t2.micro"
  ami = "ami-0c55b159cbfafe1f0"
}
```

`providers.tf`:

```hcl
terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = ">= 3.0.0"
    }
  }
}

provider "aws" {
  region = var.region
}
```

`variables.tf`:

```hcl
variable "region" {
  description = "The AWS region to deploy to"
  default     = "us-west-2"
}
```

`outputs.tf`:

```hcl
output "vpc_id" {
  value = module.vpc.vpc_id
}

output "instance_id" {
  value = module.ec2.instance_id
}
```

#### Environment-Specific Variable Files

`environments/dev.tfvars`:

```hcl
region = "us-west-2"
```

`environments/staging.tfvars`:

```hcl
region = "us-east-1"
```

`environments/prod.tfvars`:

```hcl
region = "eu-west-1"
```

### Using the Simplified Structure

To apply configurations for a specific environment, you can pass the appropriate `tfvars` file:

```bash
terraform apply -var-file=environments/dev.tfvars
```

### Summary

While a well-structured project with multiple files offers many benefits for large and complex projects, starting with a simpler structure can help you get up and running quickly. As your project grows, you can gradually adopt a more modular and organized approach to maintain scalability and manageability. Choose a structure that fits your current needs and allows for future expansion.

## Advanced Project Structure

```txt
my-terraform-project/
├── modules/
│   ├── vpc/
│   │   ├── main.tf
│   │   ├── variables.tf
│   │   └── outputs.tf
│   ├── ec2/
│   │   ├── main.tf
│   │   ├── variables.tf
│   │   └── outputs.tf
│   └── s3/
│       ├── main.tf
│       ├── variables.tf
│       └── outputs.tf
├── environments/
│   ├── dev/
│   │   ├── main.tf
│   │   ├── variables.tf
│   │   └── terraform.tfvars
│   ├── staging/
│   │   ├── main.tf
│   │   ├── variables.tf
│   │   └── terraform.tfvars
│   └── prod/
│       ├── main.tf
│       ├── variables.tf
│       └── terraform.tfvars
├── main.tf
├── providers.tf
├── variables.tf
├── outputs.tf
└── terraform.tfvars
```

### Detailed File Contents

#### Root Directory Files

`main.tf`:

```hcl
module "vpc" {
  source = "./modules/vpc"
  cidr_block = "10.0.0.0/16"
  name = "example-vpc"
}

module "ec2" {
  source = "./modules/ec2"
  instance_type = "t2.micro"
  ami = "ami-0c55b159cbfafe1f0"
}
```

`providers.tf`:

```hcl
terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = ">= 3.0.0"
    }
  }
}

provider "aws" {
  region     = var.region
  access_key = "your-access-key"
  secret_key = "your-secret-key"
}
```

`variables.tf`:

```hcl
variable "region" {
  description = "The AWS region to deploy to"
  default     = "us-west-2"
}
```

`outputs.tf`:

```hcl
output "vpc_id" {
  value = module.vpc.vpc_id
}

output "instance_id" {
  value = module.ec2.instance_id
}
```

#### VPC Module

`modules/vpc/main.tf`:

```hcl
resource "aws_vpc" "this" {
  cidr_block = var.cidr_block

  tags = {
    Name = var.name
  }
}
```

`modules/vpc/variables.tf`:

```hcl
variable "cidr_block" {
  description = "The CIDR block for the VPC"
  type        = string
}

variable "name" {
  description = "The name of the VPC"
  type        = string
}
```

`modules/vpc/outputs.tf`:

```hcl
output "vpc_id" {
  value = aws_vpc.this.id
}
```

#### EC2 Module

`modules/ec2/main.tf`:

```hcl
resource "aws_instance" "this" {
  ami           = var.ami
  instance_type = var.instance_type

  tags = {
    Name = var.name
  }
}
```

`modules/ec2/variables.tf`:

```hcl
variable "ami" {
  description = "The AMI to use for the instance"
  type        = string
}

variable "instance_type" {
  description = "The instance type to use"
  type        = string
}

variable "name" {
  description = "The name of the instance"
  default     = "example-instance"
}
```

`modules/ec2/outputs.tf`:

```hcl
output "instance_id" {
  value = aws_instance.this.id
}
```

### Environment-Specific Configuration

**Development Environment Example:**

`environments/dev/main.tf`:

```hcl
module "vpc" {
  source = "../../modules/vpc"
  cidr_block = "10.0.0.0/16"
  name = "dev-vpc"
}

module "ec2" {
  source = "../../modules/ec2"
  instance_type = "t2.micro"
  ami = "ami-0c55b159cbfafe1f0"
}
```

`environments/dev/terraform.tfvars`:

```hcl
region = "us-west-2"
```

### Summary

- **Root Directory**: High-level configurations (`main.tf`, `variables.tf`, `outputs.tf`, `providers.tf`, `terraform.tfvars`).
- **Modules Directory**: Encapsulated, reusable configurations for specific resources (e.g., `vpc`, `ec2`).
- **Environments Directory**: Environment-specific configurations (`dev`, `staging`, `prod`).
- **Providers Configuration**: Using a `providers.tf` file to define provider requirements and settings.

This structure helps keep your Terraform project organized, scalable, and maintainable, with a clear separation of concerns and reusable modules.
